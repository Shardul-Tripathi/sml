\begin{figure}
\begin{lstlisting}[language=C, mathescape=true]
//circuit builders for arithmetic and boolean
Circuit* ycirc = s[S_YAO]->GetCircuitBuildRoutine();
Circuit* acirc = s[S_ARITH]->GetCircuitBuildRoutine();
...
if(role == SERVER) { 
  //Put gates to read w and b
} else { //role == CLIENT
  //Put gates to read x
}

for(uint32_t i = 0; i < 30; i++) { //acc = w$^{\text{{\color{red}T}}}$x$~\label{line:dotproductloop}$
  share * a_t_0 = acirc->PutMULGate(a_w[i], a_x[i]);$~\label{line:dotmulgate}$
  a_acc = acirc->PutADDGate(a_acc, a_t_0 );$~\label{line:dotaddgate}$
}

//convert acc and b from arithmetic to boolean
share *y_acc = ycirc->PutA2YGate(a_acc);$~\label{line:convacc}$
share *y_b = ycirc->PutA2YGate(a_b);$~\label{line:convb}$

share *y_pred = ycirc->PutGTGate (y_acc, y_b);$~\label{line:condyaobegin}$
uint32_t one = 1 ;
share *y_1 = ycirc->PutCONSGate(one, bitlen);
uint32_t zero = 0 ;
share *y_0 = ycirc->PutCONSGate(zero, bitlen);
share *y_t = ycirc->PutMUXGate(y_pred, y_1, y_0);$~\label{line:condyaoend}$

share *y_out = ycirc->PutOUTGate(y_t, CLIENT);
party->ExecCircuit();

if(role==CLIENT) {  //only to the client
  uint32_t _o = y_out->get_clear_value<uint32_t>();
}
\end{lstlisting}
\caption{\tool compiler (partial) output for Figure~\ref{fig:ex-sml}}
\label{fig:ex-aby}
\end{figure}
